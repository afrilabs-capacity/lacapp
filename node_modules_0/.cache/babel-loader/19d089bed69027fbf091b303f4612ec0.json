{"ast":null,"code":"var _this = this,\n    _jsxFileName = \"C:\\\\react\\\\lac\\\\src\\\\editor\\\\RichText.js\";\n\nimport React, { useContext, useEffect } from 'react';\nimport { Editor } from '@tinymce/tinymce-react';\nimport ArticleProvider from \"../context/ArticleContext\";\nvar myEditor = null;\n\nfunction addImageToEditor() {\n  myEditor !== null && myEditor.insertContent('<img alt=\"Smiley face\" class=\"mce-responsive\" src=\"' + selectedImageGlobal + '\"/>');\n}\n\nfunction addImageToEditorCondition() {\n  return selectedImageGlobal !== \"\";\n}\n\nfunction useEffectIf(condition, fn) {\n  return useEffect(function () {\n    return condition && fn();\n  }, [condition]);\n}\n\nvar RichText = function RichText(_ref) {\n  var actionType = _ref.actionType;\n\n  var _useContext = useContext(ArticleProvider.Context),\n      setSelectedImageGlobal = _useContext.setSelectedImageGlobal,\n      selectedImageGlobal = _useContext.selectedImageGlobal,\n      currentArticle = _useContext.currentArticle,\n      editMode = _useContext.editMode,\n      article = _useContext.article,\n      updateArticle = _useContext.updateArticle,\n      modal = _useContext.modal,\n      setModal = _useContext.setModal;\n\n  var key = \"xxx\";\n  useEffect(function () {\n    useEffectIf(addImageToEditorCondition, addImageToEditor);\n  }, [selectedImageGlobal]);\n\n  var setUpdateModeOrNot = function setUpdateModeOrNot() {\n    if (actionType == \"en\" && editMode == \"update\" && article.body_en !== null) {\n      key = Math.random();\n      console.log(\"Editor key\", key);\n      return article.body_en;\n    }\n\n    if (actionType == \"fr\" && editMode == \"update\" && article.body_fr !== null) {\n      key = Math.random();\n      console.log(\"Editor key\", key);\n      return article.body_fr;\n    }\n\n    return \"\";\n  };\n\n  var handleEditorChange = function handleEditorChange(content) {\n    actionType == \"en\" ? updateArticle(\"body_en\", content) : updateArticle(\"body_fr\", content);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Editor, {\n    apiKey: \"mymryl9rtn2npjz2vhp3yovdx2of4phahbqil1sq29upca83\",\n    value: setUpdateModeOrNot(),\n    init: {\n      height: 500,\n      menubar: true,\n      plugins: ['advlist autolink lists link image', 'charmap print preview anchor help', 'searchreplace visualblocks code', 'insertdatetime media table paste wordcount'],\n      setup: function setup(editor) {\n        myEditor = editor;\n\n        function toTimeHtml(date) {\n          return '<time datetime=\"' + date.toString() + '\">' + date.toDateString() + '</time>';\n        }\n\n        function insertDate() {\n          var html = toTimeHtml(new Date());\n          editor.insertContent(html);\n        }\n\n        editor.ui.registry.addButton('gallery', {\n          icon: 'image',\n          //image: 'http://p.yusukekamiyamane.com/icons/search/fugue/icons/calendar-blue.png',\n          tooltip: \"Insert Current Date\",\n          onAction: function onAction() {\n            setModal(true);\n            myEditor = editor; //\n          }\n        });\n      },\n      toolbar: 'gallery | insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | table | print preview ',\n      file_browser_callback_types: 'image',\n      file_picker_callback: function file_picker_callback(callback, value, meta) {\n        if (meta.filetype == 'image') {\n          var input = document.getElementById('my-file');\n          input.click();\n\n          input.onchange = function () {\n            var file = input.files[0];\n            var reader = new FileReader();\n\n            reader.onload = function (e) {\n              console.log('name', e.target.result);\n              callback(e.target.result, {\n                alt: file.name\n              });\n            };\n\n            reader.readAsDataURL(file);\n          };\n        }\n      },\n      content_style: 'img { width:100%}',\n      image_dimensions: false,\n      image_class_list: [{\n        title: 'None',\n        value: 'mce-responsive'\n      }],\n      contextmenu: 'link image table',\n      paste_data_images: true\n    },\n    onEditorChange: function onEditorChange(e) {\n      return handleEditorChange(e);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default RichText;","map":{"version":3,"sources":["C:/react/lac/src/editor/RichText.js"],"names":["React","useContext","useEffect","Editor","ArticleProvider","myEditor","addImageToEditor","insertContent","selectedImageGlobal","addImageToEditorCondition","useEffectIf","condition","fn","RichText","actionType","Context","setSelectedImageGlobal","currentArticle","editMode","article","updateArticle","modal","setModal","key","setUpdateModeOrNot","body_en","Math","random","console","log","body_fr","handleEditorChange","content","height","menubar","plugins","setup","editor","toTimeHtml","date","toString","toDateString","insertDate","html","Date","ui","registry","addButton","icon","tooltip","onAction","toolbar","file_browser_callback_types","file_picker_callback","callback","value","meta","filetype","input","document","getElementById","click","onchange","file","files","reader","FileReader","onload","e","target","result","alt","name","readAsDataURL","content_style","image_dimensions","image_class_list","title","contextmenu","paste_data_images"],"mappings":"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","sourcesContent":["import React,{useContext,useEffect} from 'react';\r\nimport { Editor } from '@tinymce/tinymce-react';\r\nimport ArticleProvider from \"../context/ArticleContext\"\r\n\r\nvar myEditor=null\r\n\r\nfunction addImageToEditor(){\r\n   myEditor!==null && myEditor.insertContent('<img alt=\"Smiley face\" class=\"mce-responsive\" src=\"' + selectedImageGlobal + '\"/>')\r\n   }\r\n\r\n\r\n function addImageToEditorCondition(){\r\n   return selectedImageGlobal!==\"\"\r\n }\r\n\r\n\r\nfunction useEffectIf(condition, fn) {\r\n  return useEffect(() => condition && fn(), [condition])\r\n}\r\n\r\nconst RichText =({actionType})=> {\r\n  const {setSelectedImageGlobal,selectedImageGlobal,currentArticle,editMode,article,updateArticle,modal,setModal}=useContext(ArticleProvider.Context)\r\n\r\n let key=\"xxx\"\r\n\r\n\r\n\r\n useEffect(()=>{\r\n  useEffectIf(addImageToEditorCondition, addImageToEditor)\r\n \r\n },\r\n [selectedImageGlobal])\r\n\r\n  const setUpdateModeOrNot=()=>{\r\n\r\n    if(actionType==\"en\" && editMode==\"update\" && article.body_en!==null){\r\n      key=Math.random()\r\n      console.log(\"Editor key\",key)\r\n      return  article.body_en\r\n\r\n    }\r\n\r\n    if(actionType==\"fr\" && editMode==\"update\" && article.body_fr!==null){\r\n      key=Math.random()\r\n      console.log(\"Editor key\",key)\r\n      return  article.body_fr\r\n\r\n    }\r\n\r\n    return \"\"\r\n\r\n\r\n  }\r\n\r\n\r\n  const handleEditorChange = (content) => {\r\n    actionType==\"en\" ? updateArticle(\"body_en\", content):  updateArticle(\"body_fr\", content)\r\n  }\r\n\r\n  \r\n    return (\r\n      <>\r\n      {/* <input id=\"my-file\" type=\"file\" name=\"my-file\" style={{display:\"none\"}} onChange=\"\" /> */}\r\n\r\n      <Editor\r\n      \r\n      apiKey=\"mymryl9rtn2npjz2vhp3yovdx2of4phahbqil1sq29upca83\"\r\n       value={setUpdateModeOrNot()}\r\n      \r\n   \r\n        init={{\r\n          height: 500,\r\n          menubar: true,\r\n          plugins: [\r\n            'advlist autolink lists link image',\r\n            'charmap print preview anchor help',\r\n            'searchreplace visualblocks code',\r\n            'insertdatetime media table paste wordcount'\r\n          ],\r\n        \r\n        \r\n        setup:function (editor) {\r\n\r\n          myEditor=editor\r\n\r\n                function toTimeHtml(date) {\r\n          return '<time datetime=\"' + date.toString() + '\">' + date.toDateString() + '</time>';\r\n        }\r\n\r\n        function insertDate() {\r\n      var html = toTimeHtml(new Date());\r\n      editor.insertContent(html);\r\n    }\r\n\r\n        editor.ui.registry.addButton('gallery', {\r\n          icon: 'image',\r\n          //image: 'http://p.yusukekamiyamane.com/icons/search/fugue/icons/calendar-blue.png',\r\n          tooltip: \"Insert Current Date\",\r\n          onAction:()=> {\r\n           \r\n            setModal(true)\r\n            myEditor=editor\r\n            //\r\n            }\r\n        });\r\n    },\r\n         \r\n        toolbar: 'gallery | insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | table | print preview ',\r\n              \r\n              file_browser_callback_types: 'image',\r\n              file_picker_callback: function (callback, value, meta) {\r\n                if (meta.filetype == 'image') {\r\n                    var input = document.getElementById('my-file');\r\n                    input.click();\r\n                    input.onchange = function () {\r\n                        var file = input.files[0];\r\n                        var reader = new FileReader();\r\n                        reader.onload = function (e) {\r\n                            console.log('name',e.target.result);\r\n                            callback(e.target.result, {\r\n                                alt: file.name\r\n                            });\r\n                        };\r\n                        reader.readAsDataURL(file);\r\n                    };\r\n                }\r\n            },\r\n            content_style: 'img { width:100%}',\r\n            image_dimensions: false,\r\n            image_class_list: [\r\n    {title: 'None', value: 'mce-responsive'},\r\n\r\n  \r\n  ],\r\n  contextmenu: 'link image table',\r\n              paste_data_images: true,\r\n\r\n              }}\r\n\r\n        onEditorChange={(e)=>handleEditorChange(e)}\r\n\r\n        \r\n      /></>\r\n    );\r\n\r\n}\r\n\r\nexport default RichText;"]},"metadata":{},"sourceType":"module"}