{"ast":null,"code":"import _toConsumableArray from \"C:\\\\react\\\\lac\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"C:\\\\react\\\\lac\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"C:\\\\react\\\\lac\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"C:\\\\react\\\\lac\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\react\\\\lac\\\\src\\\\context\\\\ArticleContext.js\";\n\nimport React, { createContext, useState, useEffect } from \"react\";\nimport { useHistory, useLocation, useParams } from \"react-router-dom\";\nimport PropTypes from \"prop-types\";\nimport axios from \"axios\";\nvar Context = createContext({});\nvar initialArticle = {\n  id: null,\n  title_en: \"\",\n  body_en: null,\n  featured_en: null,\n  title_fr: \"\",\n  body_fr: null,\n  featured_fr: null,\n  status: \"draft\",\n  category: \"\",\n  created_at: null,\n  updated_at: null\n};\nvar initialEditArticle = {\n  id: null,\n  title_en: \"\",\n  body_en: null,\n  featured_en: null,\n  title_fr: \"\",\n  body_fr: null,\n  featured_fr: null,\n  status: \"draft\",\n  category: \"\",\n  created_at: null,\n  updated_at: null\n};\nvar API_URL = \"http://192.168.43.122:8080/laravel/site40/public/api/v1/\";\n\nvar Provider = function Provider(props) {\n  // Initial values are obtained from the props\n  var history = useHistory();\n\n  var _useParams = useParams(),\n      id = _useParams.id;\n\n  var location = useLocation();\n  var errorCount;\n  var children = props.children; // Use State to keep the values\n\n  var _useState = useState(initialArticle),\n      _useState2 = _slicedToArray(_useState, 2),\n      article = _useState2[0],\n      setArticle = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      toast = _useState4[0],\n      setToast = _useState4[1];\n\n  var _useState5 = useState(\"error\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      toastType = _useState6[0],\n      setToastType = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      modal = _useState8[0],\n      setModal = _useState8[1];\n\n  var _useState9 = useState([]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      errors = _useState10[0],\n      setErrors = _useState10[1];\n\n  var _useState11 = useState(\"\"),\n      _useState12 = _slicedToArray(_useState11, 2),\n      selectedImageEn = _useState12[0],\n      setSelectedImageEn = _useState12[1];\n\n  var _useState13 = useState(\"\"),\n      _useState14 = _slicedToArray(_useState13, 2),\n      selectedImageFr = _useState14[0],\n      setSelectedImageFr = _useState14[1];\n\n  var _useState15 = useState(\"\"),\n      _useState16 = _slicedToArray(_useState15, 2),\n      featuredFor = _useState16[0],\n      setFeaturedFor = _useState16[1];\n\n  var _useState17 = useState(\"new\"),\n      _useState18 = _slicedToArray(_useState17, 2),\n      editMode = _useState18[0],\n      setEditMode = _useState18[1];\n\n  var _useState19 = useState(\"\"),\n      _useState20 = _slicedToArray(_useState19, 2),\n      currentArticle = _useState20[0],\n      setCurrentArticle = _useState20[1]; // const [featuredFor,setFeaturedFor]=useState(\"\")\n\n\n  useEffect(function () {\n    //console.log(\"id\",id)\n    updateFeatured();\n    console.log(\"article rebuilt\", article);\n  }, [article]);\n\n  var updateArticle = function updateArticle(dataKey, data) {\n    //console.log(\"data key\", dataKey) \n    return setArticle(function (prevState) {\n      var newState = _objectSpread(_objectSpread({}, prevState), {}, _defineProperty({}, dataKey, data));\n\n      return newState;\n    });\n  };\n\n  var updateFeatured = function updateFeatured() {\n    //console.log(\"data key\", dataKey) \n    article.featured_en !== null && setSelectedImageEn(article.featured_en);\n    article.featured_fr !== null && setSelectedImageFr(article.featured_fr);\n  };\n\n  var resetArticle = function resetArticle() {\n    setArticle(initialArticle);\n    setSelectedImageEn(\"\");\n    setSelectedImageFr(\"\");\n    setCurrentArticle(\"\");\n    setToast(false);\n  };\n\n  var resetEditArticle = function resetEditArticle() {\n    setArticle(initialEditArticle);\n  };\n\n  var validateArticle = function validateArticle() {\n    setErrors([]);\n    setToast(false);\n    errorCount = 0;\n    var tmpErrors = [];\n\n    if (article.status == \"published\") {\n      if (article.title_en == \"\") {\n        tmpErrors.push(\"Please enter article title (english) before publishing as (published status)\");\n        errorCount++;\n      }\n\n      if (article.body_en == null) {\n        tmpErrors.push(\"Please enter article body (english) before publishing as (published status)\");\n        errorCount++;\n      }\n\n      if (article.category == \"\") {\n        tmpErrors.push(\"Please select category before publishing as (published status)\");\n        errorCount++;\n      }\n    }\n\n    if (article.status == \"draft\") {\n      if (article.title_en == \"\") {\n        tmpErrors.push(\"Please enter article title (english) before publishing as (draft status)\");\n        errorCount++;\n      }\n    }\n\n    errorCount > 0 && setErrors(function (prevError) {\n      return [].concat(_toConsumableArray(prevError), tmpErrors);\n    });\n    editMode == \"new\" && errorCount == 0 && publishArticleApi();\n    editMode == \"update\" && errorCount == 0 && updateArticleApi();\n  };\n\n  var publishArticleApi = function publishArticleApi() {\n    axios.request({\n      method: \"post\",\n      url: API_URL + \"post/new\",\n      data: article\n    }).then(function (response) {\n      // updateGallery([])\n      //   updateGallery(prevGallery=>[\n      //     ...prevGallery,...response.data.data.data.data\n      //   ])\n      setEditMode(\"update\");\n      history.replace({\n        pathname: '/posts/edit/' + response.data.data.data.id,\n        //search: '?query=abc',\n        id: response.data.data.data.id,\n        state: {\n          id: response.data.data.data.id,\n          navType: \"post_save\",\n          data: response.data.data.data\n        }\n      });\n      console.log(\"post response\", response.data.data.data.id);\n    }).catch(function (error) {\n      setErrors([]);\n      setErrors(function (prevError) {\n        return [].concat(_toConsumableArray(prevError), [error.response.statusText]);\n      });\n    });\n  };\n\n  var updateArticleApi = function updateArticleApi() {\n    axios.request({\n      method: \"post\",\n      url: API_URL + \"post/update\",\n      data: article\n    }).then(function (response) {\n      // updateGallery([])\n      //   updateGallery(prevGallery=>[\n      //     ...prevGallery,...response.data.data.data.data\n      //   ])\n      setEditMode(\"update\");\n      setToastType(\"success\");\n      setErrors(function (prevError) {\n        return [].concat(_toConsumableArray(prevError), [\"Updated\"]);\n      });\n      setToast(true);\n      console.log(\"post response\", response.data.data.data.id);\n    }).catch(function (error) {\n      setErrors([]);\n      var apiStatus = error.response !== undefined ? error.response.statusText : \"Unknown error\";\n      setErrors(function (prevError) {\n        return [].concat(_toConsumableArray(prevError), [apiStatus]);\n      });\n    });\n  };\n\n  var fetchArticleByIdApi = function fetchArticleByIdApi(id) {\n    axios.get(API_URL + \"post/\" + id).then(function (response) {\n      setArticle(function (prevArticle) {\n        return _objectSpread(_objectSpread({}, prevArticle), response.data.data.data);\n      });\n      console.log(\"post response\", response.data.data.data);\n    }).catch(function (error) {\n      setErrors([]);\n      var apiStatus = error.response !== undefined ? error.response.statusText : \"Unknown error\";\n      setErrors(function (prevError) {\n        return [].concat(_toConsumableArray(prevError), [apiStatus]);\n      });\n    });\n  };\n\n  var articleContext = {\n    article: article,\n    updateArticle: updateArticle,\n    toast: toast,\n    setToast: setToast,\n    modal: modal,\n    setModal: setModal,\n    errors: errors,\n    validateArticle: validateArticle,\n    selectedImageFr: selectedImageFr,\n    selectedImageEn: selectedImageEn,\n    setSelectedImageEn: setSelectedImageEn,\n    setSelectedImageFr: setSelectedImageFr,\n    setFeaturedFor: setFeaturedFor,\n    featuredFor: featuredFor,\n    editMode: editMode,\n    setCurrentArticle: setCurrentArticle,\n    setArticle: setArticle,\n    setEditMode: setEditMode,\n    resetArticle: resetArticle,\n    resetEditArticle: resetEditArticle,\n    initialEditArticle: initialEditArticle,\n    toastType: toastType,\n    setToastType: setToastType,\n    fetchArticleByIdApi: fetchArticleByIdApi\n  }; // pass the value in provider and return\n\n  return /*#__PURE__*/React.createElement(Context.Provider, Object.assign({\n    value: articleContext\n  }, props, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 10\n    }\n  }), children);\n};\n\nvar ArticleProvider = {\n  Provider: Provider,\n  Context: Context\n};\nProvider.propTypes = {\n  article: PropTypes.object\n};\nProvider.defaultProps = {\n  article: {\n    title_en: \"\",\n    body_en: null,\n    featured_en: null,\n    title_fr: \"\",\n    body_fr: null,\n    featured_fr: null,\n    status: \"draft\"\n  }\n};\nexport default ArticleProvider;","map":{"version":3,"sources":["C:/react/lac/src/context/ArticleContext.js"],"names":["React","createContext","useState","useEffect","useHistory","useLocation","useParams","PropTypes","axios","Context","initialArticle","id","title_en","body_en","featured_en","title_fr","body_fr","featured_fr","status","category","created_at","updated_at","initialEditArticle","API_URL","Provider","props","history","location","errorCount","children","article","setArticle","toast","setToast","toastType","setToastType","modal","setModal","errors","setErrors","selectedImageEn","setSelectedImageEn","selectedImageFr","setSelectedImageFr","featuredFor","setFeaturedFor","editMode","setEditMode","currentArticle","setCurrentArticle","updateFeatured","console","log","updateArticle","dataKey","data","prevState","newState","resetArticle","resetEditArticle","validateArticle","tmpErrors","push","prevError","publishArticleApi","updateArticleApi","request","method","url","then","response","replace","pathname","state","navType","catch","error","statusText","apiStatus","undefined","fetchArticleByIdApi","get","prevArticle","articleContext","ArticleProvider","propTypes","object","defaultProps"],"mappings":"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","sourcesContent":["import React, { createContext, useState,useEffect} from \"react\";\r\nimport { useHistory,useLocation,useParams } from \"react-router-dom\";\r\nimport PropTypes from \"prop-types\";\r\nimport axios from \"axios\"\r\n\r\nconst Context = createContext({});\r\n\r\nconst initialArticle={\r\n    id:null,\r\n    title_en: \"\",\r\n    body_en: null,\r\n    featured_en:null,\r\n    title_fr: \"\",\r\n    body_fr: null,\r\n    featured_fr:null,\r\n    status:\"draft\",\r\n    category:\"\",\r\n    created_at:null,\r\n    updated_at:null\r\n}\r\n\r\n\r\nconst initialEditArticle={\r\n id:null,\r\n title_en: \"\",\r\n body_en: null,\r\n featured_en:null,\r\n title_fr: \"\",\r\n body_fr: null,\r\n featured_fr:null,\r\n status:\"draft\",\r\n category:\"\",\r\n created_at:null,\r\n updated_at:null\r\n}\r\n\r\n\r\nconst API_URL = \"http://192.168.43.122:8080/laravel/site40/public/api/v1/\";\r\n\r\n const Provider = props => {\r\n  // Initial values are obtained from the props\r\n const history = useHistory();\r\n\r\nconst {id} = useParams();\r\n\r\nconst location = useLocation();\r\n\r\nlet errorCount\r\n \r\n  const {\r\n    // article:initialArticle,\r\n    children\r\n  } = props;\r\n\r\n  // Use State to keep the values\r\n  const [article,setArticle] = useState(initialArticle);\r\n  const [toast,setToast]=useState(false)\r\n  const [toastType,setToastType]=useState(\"error\")\r\n  const [modal,setModal]=useState(false)\r\n  const [errors,setErrors]=useState([])\r\n  const [selectedImageEn,setSelectedImageEn]=useState(\"\")\r\n  const [selectedImageFr,setSelectedImageFr]=useState(\"\")\r\n  const [featuredFor,setFeaturedFor]=useState(\"\")\r\n  const [editMode,setEditMode]=useState(\"new\")\r\n  const [currentArticle,setCurrentArticle]=useState(\"\")\r\n  // const [featuredFor,setFeaturedFor]=useState(\"\")\r\n\r\n  useEffect(()=>{\r\n//console.log(\"id\",id)\r\nupdateFeatured()\r\nconsole.log(\"article rebuilt\",article)\r\n  },[article])\r\n  \r\n\r\n  const updateArticle=(dataKey,data)=> \r\n  {\r\n     //console.log(\"data key\", dataKey) \r\n    return setArticle(prevState => { \r\n         let newState=({...prevState,[dataKey]: data})\r\n          return newState\r\n        })  \r\n  }\r\n\r\n  const updateFeatured=()=> \r\n  {\r\n     //console.log(\"data key\", dataKey) \r\n     article.featured_en!==null && setSelectedImageEn( article.featured_en)\r\n\r\n     article.featured_fr!==null && setSelectedImageFr( article.featured_fr)\r\n    \r\n  }\r\n  \r\n  const resetArticle=()=> \r\n  {\r\n    setArticle(initialArticle)\r\n    setSelectedImageEn(\"\")\r\n    setSelectedImageFr(\"\")\r\n    setCurrentArticle(\"\")\r\n    setToast(false)\r\n  }\r\n\r\n\r\n\r\n  const resetEditArticle=()=> \r\n  {\r\n    setArticle(initialEditArticle)\r\n  }\r\n\r\n\r\n  const validateArticle= ()=>{\r\n      setErrors([])\r\n      setToast(false)\r\n      errorCount=0\r\n      let tmpErrors=[]\r\n        if(article.status==\"published\"){\r\n        if(article.title_en==\"\"){\r\n          tmpErrors.push(\"Please enter article title (english) before publishing as (published status)\")\r\n           errorCount++\r\n        }\r\n\r\n        if(article.body_en==null){\r\n          tmpErrors.push(\"Please enter article body (english) before publishing as (published status)\")\r\n          errorCount++\r\n        } \r\n\r\n        if(article.category==\"\"){\r\n          tmpErrors.push(\"Please select category before publishing as (published status)\")\r\n          errorCount++\r\n      } \r\n\r\n       \r\n\r\n        }\r\n\r\n        if(article.status==\"draft\"){\r\n            if(article.title_en==\"\"){\r\n              tmpErrors.push(\"Please enter article title (english) before publishing as (draft status)\")\r\n          errorCount++\r\n               \r\n            } \r\n            \r\n           \r\n        }\r\n\r\n       \r\n        errorCount>0 && setErrors(prevError=>[...prevError,...tmpErrors])\r\n\r\n       editMode==\"new\" && errorCount==0 && publishArticleApi()\r\n\r\n       editMode==\"update\" && errorCount==0 && updateArticleApi()\r\n       \r\n        \r\n\r\n  }\r\n  \r\n\r\n  const publishArticleApi =()=>{\r\n\r\n    axios.request( {\r\n      method: \"post\", \r\n      url: API_URL+\"post/new\", \r\n      data: article\r\n    }).then (response => {\r\n      // updateGallery([])\r\n      //   updateGallery(prevGallery=>[\r\n      //     ...prevGallery,...response.data.data.data.data\r\n      //   ])\r\n      setEditMode(\"update\")\r\n      history.replace({\r\n        pathname: '/posts/edit/'+response.data.data.data.id,\r\n        //search: '?query=abc',\r\n        id:response.data.data.data.id,\r\n        state: { id: response.data.data.data.id,navType:\"post_save\",data:response.data.data.data }\r\n    });\r\n      console.log(\"post response\",response.data.data.data.id)\r\n    }).catch(error => {\r\n      setErrors([])\r\n      setErrors(prevError=>[...prevError,error.response.statusText])\r\n      \r\n  });\r\n\r\n  }\r\n\r\n\r\n\r\n  \r\n  const updateArticleApi =()=>{\r\n\r\n    axios.request( {\r\n      method: \"post\", \r\n      url: API_URL+\"post/update\", \r\n      data: article\r\n    }).then (response => {\r\n      // updateGallery([])\r\n      //   updateGallery(prevGallery=>[\r\n      //     ...prevGallery,...response.data.data.data.data\r\n      //   ])\r\n      setEditMode(\"update\")\r\n      setToastType(\"success\")\r\n      setErrors(prevError=>[...prevError,\"Updated\"])\r\n      setToast(true)\r\n      \r\n     \r\n      console.log(\"post response\",response.data.data.data.id)\r\n    }).catch(error => {\r\n      setErrors([])\r\n      let apiStatus=error.response!==undefined ? error.response.statusText : \"Unknown error\"\r\n      setErrors(prevError=>[...prevError,apiStatus])\r\n      \r\n  });\r\n\r\n  }\r\n\r\n\r\n  const fetchArticleByIdApi =(id)=>{\r\n\r\n    axios.get( API_URL+\"post/\"+id).then (response => {\r\n      setArticle(prevArticle=>{\r\n        return {...prevArticle,...response.data.data.data}\r\n      })\r\n      \r\n     \r\n      console.log(\"post response\",response.data.data.data)\r\n    }).catch(error => {\r\n      setErrors([])\r\n      let apiStatus=error.response!==undefined ? error.response.statusText : \"Unknown error\"\r\n      setErrors(prevError=>[...prevError,apiStatus])\r\n      \r\n  });\r\n\r\n  }\r\n\r\n\r\n  const articleContext = {\r\n    article,\r\n    updateArticle,\r\n    toast,\r\n    setToast,\r\n    modal,\r\n    setModal,\r\n    errors,\r\n    validateArticle,\r\n    selectedImageFr,\r\n    selectedImageEn,\r\n    setSelectedImageEn,\r\n    setSelectedImageFr,\r\n    setFeaturedFor,\r\n    featuredFor,\r\n    editMode,\r\n    setCurrentArticle,\r\n    setArticle,\r\n    setEditMode,\r\n    resetArticle,\r\n    resetEditArticle,\r\n    initialEditArticle,\r\n    toastType,\r\n    setToastType,\r\n    fetchArticleByIdApi,\r\n    \r\n\r\n  };\r\n\r\n  // pass the value in provider and return\r\n  return <Context.Provider value={articleContext}  {...props}>{children }</Context.Provider>;\r\n};\r\n\r\n\r\nconst ArticleProvider= {\r\n    Provider,\r\n    Context\r\n};\r\n\r\nProvider.propTypes = {\r\n    article:PropTypes.object,  \r\n};\r\n\r\nProvider.defaultProps = {\r\n  article: {\r\n    title_en: \"\",\r\n    body_en: null,\r\n    featured_en:null,\r\n    title_fr: \"\",\r\n    body_fr: null,\r\n    featured_fr:null,\r\n    status:\"draft\"\r\n  },\r\n\r\n\r\n};\r\n\r\n\r\nexport default ArticleProvider"]},"metadata":{},"sourceType":"module"}