{"ast":null,"code":"import _defineProperty from\"C:\\\\react\\\\lac\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:\\\\react\\\\lac\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"C:\\\\react\\\\lac\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:\\\\react\\\\lac\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useContext,useEffect,useState}from\"react\";import{CModal,CModalHeader,CButton,CModalBody,CModalFooter,CRow,CCol,CProgress}from'@coreui/react';import ArticleProvider from\"../context/ArticleContext\";import PgCatProvider from\"../context/PgCatContext\";import GalleryProvider from\"../context/GalleryContext\";import InfiniteScroll from'react-infinite-scroll-component';import axios from\"axios\";import{useAlert}from'react-alert';import authHeader from\"../services/auth-header\";import urlService from\"../services/url-service\";var API_URL=urlService().baseUrl;var PUBLIC_URL=urlService().publicUrl;var Styles={link:{textDecoration:\"underline\",fontSize:\"11px\",color:\"green\"},Titles:{color:\"black\"},Theme:{background:\"rgb(250, 252, 255)\"}};var ModalMe=function ModalMe(_ref){var _React$createElement;var showToast=_ref.showToast;var _useContext=useContext(ArticleProvider.Context),initialLoginAction=_useContext.initialLoginAction,setLoginAction=_useContext.setLoginAction,setAuthModal=_useContext.setAuthModal,selectedImageGlobal=_useContext.selectedImageGlobal,setSelectedImageGlobal=_useContext.setSelectedImageGlobal,updateArticle=_useContext.updateArticle,article=_useContext.article,setArticle=_useContext.setArticle,featuredFor=_useContext.featuredFor,setSelectedImageEn=_useContext.setSelectedImageEn,setSelectedImageFr=_useContext.setSelectedImageFr,modal=_useContext.modal,setModal=_useContext.setModal;var _useContext2=useContext(GalleryProvider.Context),boy=_useContext2.boy,uploadProgress=_useContext2.uploadProgress,setUploadProgress=_useContext2.setUploadProgress;var alert=useAlert();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),gallery=_useState2[0],updateGallery=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),selectedImage=_useState4[0],setSelectedImage=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),selectedImageId=_useState6[0],setSelectedImageId=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),fileType=_useState8[0],setFileType=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),fileName=_useState10[0],setFileName=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),fileSize=_useState12[0],setFileSize=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),fileDimension=_useState14[0],setFileDimension=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),fileUploadedOn=_useState16[0],setFileUploadedOn=_useState16[1];var _useState17=useState({}),_useState18=_slicedToArray(_useState17,2),pagination=_useState18[0],setPagination=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),hasMore=_useState20[0],setHasMore=_useState20[1];var _useState21=useState(null),_useState22=_slicedToArray(_useState21,2),successMsg=_useState22[0],setSuccessMsg=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),uploading=_useState24[0],setUploading=_useState24[1];//const [loginAction,setLoginAction] =useState(initialLoginAction)\nvar loadMore=false;var selectedImageIdv=null;var triggerSelectInput=function triggerSelectInput(e,input){e.preventDefault();input.click();};useEffect(function(){var uploadBt=document.getElementById(\"modal-upload-bt\");var uploadInput=document.getElementById(\"modal-upload-input\");uploadBt.addEventListener(\"click\",function(e){return triggerSelectInput(e,uploadInput);});// document.addEventListener(\"click\",(e)=>{ \n//   if (e.target.tagName == 'A' && e.target.classList.contains(\"acpb_featured_delete\")) {\n//     e.preventDefault(); \n//     deletePhoto()\n//     //setSelectedImageEn(\"\")\n//     //updateArticle(\"featured_en\",null)\n//   }\n// })\n//console.log(\"gallery from useEffect\",gallery)\nfetchGallery();},[]);useEffect(function(){if(pagination.next_page_url&&pagination.next_page_url!==null){setHasMore(true);//alert.show(pagination.next_page_url,{type: 'error',position:\"bottom center\"})\n}else{setHasMore(false);}},[pagination]);useEffect(function(){selectedImageIdv=selectedImageId;},[selectedImageId]);var fetchGallery=function fetchGallery(async){updateGallery([]);setSelectedImage(\"\");setSelectedImageId(\"\");axios.request({method:\"get\",url:API_URL+\"photo/all\",// data: data, \nonUploadProgress:function onUploadProgress(p){setUploadProgress(function(prevProgress){return prevProgress+Math.round(100*p.loaded/p.total);});//console.log(\"upload progress\",p.total/p.loaded)\n}}).then(function(response){//console.log(\"response file name\",response.data.data.data.data)\nupdateGallery(function(prevGallery){return[].concat(_toConsumableArray(prevGallery),_toConsumableArray(response.data.data.data.data));});setPagination(function(prevArticle){return _objectSpread(_objectSpread({},prevArticle),response.data.data.data);});// console.log(\"initial api fetch\",response)\n});};var deletePhoto=function deletePhoto(){//updateGallery([])\nsetLoginAction(initialLoginAction);axios.get(API_URL+\"photo/delete/\"+selectedImageId,{headers:authHeader()}).then(function(response){//fetchGallery()\nvar newList=gallery.filter(function(item){return item.id!==selectedImageId;});updateGallery(newList);setSelectedImage(\"\");console.log('delete image response',response);}).catch(function(error){if(error.response){if(error.response.status){switch(error.response.status){case 500:alert.show(error.response.statusText,{type:'error'});break;case 401:alert.show(\"Token error\",{type:'notice'});setAuthModal(true);setLoginAction(function(prevArticle){return _objectSpread(_objectSpread({},prevArticle),{},{func:deletePhoto,params:selectedImageId});});break;default:!error.response?setSuccessMsg(\"Server currently down\"):setSuccessMsg(error.response.statusText);}}else{setSuccessMsg(\"Server currently down\");}}else{setSuccessMsg(\"Invalid response\");}// let apiStatus=error.response!==undefined ? error.response.statusText : \"Unknown error\"\n// setErrors(prevError=>[...prevError,apiStatus])\n});};var LoadMore=function LoadMore(){pagination.next_page_url==null&&setHasMore(false);pagination.next_page_url!==null&&axios.request({method:\"get\",url:pagination.next_page_url}).then(function(response){//console.log(\"response file name\",response.data.data.data.data)\nupdateGallery(function(prevGallery){return[].concat(_toConsumableArray(prevGallery),_toConsumableArray(response.data.data.data.data));});setPagination(function(prevArticle){return _objectSpread(_objectSpread({},prevArticle),response.data.data.data);});// console.log(\"initial api fetch\",response)\n});};var _onChange=function onChange(e){//console.log(e.target.value)\nsetUploadProgress(0);var file=null;file=e.target.files[0]||e.dataTransfer.files[0];e.target.value=\"\";var allowed_mime_types=['image/jpeg','image/png'];var allowed_size_mb=2;if(allowed_mime_types.indexOf(file.type)==-1){//alert('Error : Incorrect file type');\nsetSuccessMsg(\"Incorrect file type\");//alert.show(\"Incorrect file type\",{type: 'error',position:\"top right\",containerStyle:{zIndex: 4}})\nreturn;}if(file.size>allowed_size_mb*1024*1024){//alert('Error : Exceeded size');\nsetSuccessMsg(\"Size limit of 2mb Exceeded\");//alert.show(\"Size limit of 1mb Exceeded\",{type: 'error',position:\"top right\"})\nreturn;}//alert(\"on change for loading files\")\nif(!file)return;// \nsetSuccessMsg(null);setUploading(true);//this.createImage(files[0]);\nvar reader=new FileReader();reader.onload=function(e){//setImage(reader.result)\n//console.log(reader.result)\n};reader.readAsDataURL(file);var data=new FormData();data.append(\"file\",file);axios.request({method:\"post\",url:API_URL+\"photo/upload\",data:data,onUploadProgress:function onUploadProgress(p){setUploadProgress(function(prevProgress){return prevProgress+Math.round(100*p.loaded/p.total);});//console.log(\"upload progress\",p.total/p.loaded)\n}}).then(function(response){updateGallery([]);//setHasMore(true)\n// updateGallery(prevGallery=>[\n//   ...prevGallery,...response.data.data.data.data\n// ])\n// setPagination(prevArticle=>{\n//   return {...prevArticle,...response.data.data.data}\n// })\n//alert.show(\"Success\",{type: 'success'})\n//console.log(\"Adding new image\",response.data.data.data)\n//  updateGallery(prevGallery=>[\n//   ...prevGallery,response.data.data.data\n// ])\n//fetchGallery()\nvar imageBig=PUBLIC_URL+response.data.data.data.img_big;setSelectedImage(imageBig);setSelectedImageId(response.data.data.data.id);setFileType(response.data.data.data.file_type);setFileName(response.data.data.data.file_original_name);setFileSize(response.data.data.data.file_size);setFileUploadedOn(response.data.data.data.created_at);updateGallery(function(prevGallery){return[response.data.data.data].concat(_toConsumableArray(gallery));});setPagination(response.data.data.pagination);console.log(\"Added new image\",gallery);setUploading(false);}).catch(function(error){setUploading(false);if(error.response){if(error.response.status){switch(error.response.status){case 500:alert.show(error.response.statusText,{type:'error'});break;case 401://alert.show(\"Token error\",{type:'notice'})\n// setAuthModal(true)\n// setLoginAction(prevArticle=>{\n//   return {...prevArticle,func:fetchArticleByIdApi,params:id}\n// })\nbreak;default:!error.response?setSuccessMsg(\"Server currently down\"):setSuccessMsg(error.response.statusText);}}else{setSuccessMsg(\"Server currently down\");}}else{setSuccessMsg(\"Invalid response\");}// let apiStatus=error.response!==undefined ? error.response.statusText : \"Unknown error\"\n// setErrors(prevError=>[...prevError,apiStatus])\n});};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(CModal,{size:\"lg\",show:modal,onClose:function onClose(){setModal(!modal);setSuccessMsg(null);}},/*#__PURE__*/React.createElement(CModalHeader,{closeButton:true},/*#__PURE__*/React.createElement(\"h3\",null,\"Gallery\")),/*#__PURE__*/React.createElement(CModalBody,null,/*#__PURE__*/React.createElement(CRow,null,/*#__PURE__*/React.createElement(CCol,{md:\"8\"},/*#__PURE__*/React.createElement(React.Fragment,null,gallery.length?/*#__PURE__*/React.createElement(InfiniteScroll,{dataLength:gallery.length,next:function next(){return LoadMore();},hasMore:hasMore,loader:\"\",scrollableTarget:\"scrollableDiv\",endMessage:/*#__PURE__*/React.createElement(\"p\",{style:{textAlign:\"center\"}},/*#__PURE__*/React.createElement(\"b\",null))},/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container\",id:\"scrollableDiv\",style:{overflowY:\"auto\",height:\"370px\"}},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-row flex-wrap align-items-start\"},gallery.length&&gallery.map(function(val,k){var imgSmall=PUBLIC_URL+val.img_small;var imageBig=PUBLIC_URL+val.img_big;//alert(\"check\")\nreturn/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4\",style:{padding:\"1em\",cursor:\"pointer\"},key:k},/*#__PURE__*/React.createElement(\"img\",{src:imgSmall,className:'img-thumbnail',onClick:function onClick(){//let imageSource=document.getElementById(\"modal-selected-image\").src.value=val\nsetSelectedImage(imageBig);setSelectedImageId(val.id);setFileType(val.file_type);setFileName(val.file_original_name);setFileSize(val.file_size);setFileUploadedOn(val.created_at);}}));}))))):\"\"),hasMore?/*#__PURE__*/React.createElement(\"b\",null,\"(scroll down for more images)\"):\"\"),/*#__PURE__*/React.createElement(CCol,{md:\"4\"},/*#__PURE__*/React.createElement(\"img\",{className:'img-fluid',id:\"modal-selected-image\",src:selectedImage!==\"\"?selectedImage:\"\"}),selectedImage!==\"\"&&/*#__PURE__*/React.createElement(\"p\",{align:\"center\",id:\"acpb_ft_rm_fr\"},/*#__PURE__*/React.createElement(\"a\",(_React$createElement={href:\"\",style:Styles.link,id:\"acpb_del_ft\",className:\"acpb_featured_delete\"},_defineProperty(_React$createElement,\"style\",{color:\"red\",textDecoration:\"underline\"}),_defineProperty(_React$createElement,\"onClick\",function onClick(e){e.preventDefault();deletePhoto();}),_React$createElement),\"delete\")),selectedImage!==\"\"&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"b\",null,\"File name:\"),\" \",fileName),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"b\",null,\"File type:\"),\" \",fileType),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"b\",null,\"File size:\"),\" \",fileSize,\"kb\"),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"b\",null,\"Uploaded on:\"),\" \",fileUploadedOn)))),/*#__PURE__*/React.createElement(CRow,{className:\"d-flex flex-row justify-content-center\"},/*#__PURE__*/React.createElement(CCol,{md:\"4\"},/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"input\",{id:\"modal-upload-input\",type:\"file\",hidden:true,onChange:function onChange(e){return _onChange(e);}}),/*#__PURE__*/React.createElement(CButton,{id:\"modal-upload-bt\",color:\"primary\",size:\"md\",block:true,md:\"12\"},uploading?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"span\",{className:\"spinner-grow spinner-grow-sm\",role:\"status\",\"aria-hidden\":\"true\"}),\"\\xA0 Uploading...\"):\"Add IMage\"),/*#__PURE__*/React.createElement(CProgress,{className:\"progress-xs\",color:\"success\",value:uploadProgress}),successMsg!==null&&/*#__PURE__*/React.createElement(\"b\",{style:{color:\"red\"}},successMsg)))),/*#__PURE__*/React.createElement(CModalFooter,null,/*#__PURE__*/React.createElement(CButton,{color:\"primary\",onClick:function onClick(){if(featuredFor!==\"\"){//setting featured image\nsetModal(function(prev){return!prev;});//console.log(\"selected Image\",selectedImage)\n//console.log(\"Featured For\",featuredFor)\nif(featuredFor==\"acpb_en_ft\"){updateArticle(\"featured_en\",selectedImage);setSelectedImageEn(selectedImage);}else{updateArticle(\"featured_fr\",selectedImage);setSelectedImageFr(selectedImage);}}else{//setting featured image\nsetModal(function(prev){return!prev;});selectedImage!==\"\"&&setSelectedImageGlobal(selectedImage);}}},\"OK\"),' ',/*#__PURE__*/React.createElement(CButton,{color:\"secondary\",onClick:function onClick(){setModal(!modal);setSuccessMsg(null);}},\"Cancel\"))));};export default ModalMe;","map":{"version":3,"sources":["C:/react/lac/src/modals/image-upload-modal.js"],"names":["React","useContext","useEffect","useState","CModal","CModalHeader","CButton","CModalBody","CModalFooter","CRow","CCol","CProgress","ArticleProvider","PgCatProvider","GalleryProvider","InfiniteScroll","axios","useAlert","authHeader","urlService","API_URL","baseUrl","PUBLIC_URL","publicUrl","Styles","link","textDecoration","fontSize","color","Titles","Theme","background","ModalMe","showToast","Context","initialLoginAction","setLoginAction","setAuthModal","selectedImageGlobal","setSelectedImageGlobal","updateArticle","article","setArticle","featuredFor","setSelectedImageEn","setSelectedImageFr","modal","setModal","boy","uploadProgress","setUploadProgress","alert","gallery","updateGallery","selectedImage","setSelectedImage","selectedImageId","setSelectedImageId","fileType","setFileType","fileName","setFileName","fileSize","setFileSize","fileDimension","setFileDimension","fileUploadedOn","setFileUploadedOn","pagination","setPagination","hasMore","setHasMore","successMsg","setSuccessMsg","uploading","setUploading","loadMore","selectedImageIdv","triggerSelectInput","e","input","preventDefault","click","uploadBt","document","getElementById","uploadInput","addEventListener","fetchGallery","next_page_url","async","request","method","url","onUploadProgress","p","prevProgress","Math","round","loaded","total","then","response","prevGallery","data","prevArticle","deletePhoto","get","headers","newList","filter","item","id","console","log","catch","error","status","show","statusText","type","func","params","LoadMore","onChange","file","target","files","dataTransfer","value","allowed_mime_types","allowed_size_mb","indexOf","size","reader","FileReader","onload","readAsDataURL","FormData","append","imageBig","img_big","file_type","file_original_name","file_size","created_at","length","textAlign","overflowY","height","map","val","k","imgSmall","img_small","padding","cursor","prev"],"mappings":"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","sourcesContent":["import React,{useContext,useEffect,useState} from \"react\"\r\nimport {\r\n    CModal,\r\n    CModalHeader,\r\n    CButton,\r\n    CModalBody,\r\n    CModalFooter,\r\n    CRow,\r\n    CCol,\r\n    CProgress\r\n  } from '@coreui/react'\r\n  import ArticleProvider from \"../context/ArticleContext\"\r\n  import PgCatProvider from \"../context/PgCatContext\"\r\n  import GalleryProvider from \"../context/GalleryContext\";\r\n  import InfiniteScroll from 'react-infinite-scroll-component';\r\n  import axios from \"axios\";\r\n  import { useAlert } from 'react-alert'\r\n  import authHeader from \"../services/auth-header\";\r\n  import urlService from \"../services/url-service\";\r\n\r\nconst API_URL = urlService().baseUrl;\r\n\r\n  const PUBLIC_URL = urlService().publicUrl;\r\n\r\n  const Styles={\r\n    link:{\r\n      textDecoration:\"underline\",\r\n      fontSize:\"11px\",\r\n      color:\"green\"\r\n    },\r\n    Titles:{\r\n      color:\"black\"\r\n    },\r\n    Theme:{\r\n      background:\"rgb(250, 252, 255)\"\r\n    }\r\n  }\r\n    \r\n\r\n\r\nconst ModalMe=({showToast})=>{\r\n\r\n  const {initialLoginAction,setLoginAction,setAuthModal,selectedImageGlobal,setSelectedImageGlobal,updateArticle,article,setArticle,featuredFor,setSelectedImageEn,setSelectedImageFr,modal,setModal}=useContext(ArticleProvider.Context)\r\n  const {boy,uploadProgress,setUploadProgress} = useContext(GalleryProvider.Context)\r\n  const alert = useAlert()\r\n\r\n  \r\n\r\n  const [gallery,updateGallery]=useState([])\r\n\r\n  const [selectedImage,setSelectedImage]=useState(\"\")\r\n  const [selectedImageId,setSelectedImageId]=useState(\"\")\r\n  const [fileType,setFileType]=useState(\"\")\r\n  const [fileName,setFileName]=useState(\"\")\r\n  const [fileSize,setFileSize]=useState(\"\")\r\n  const [fileDimension,setFileDimension]=useState(\"\")\r\n  const [fileUploadedOn,setFileUploadedOn]=useState(\"\")\r\n  const [pagination,setPagination] = useState({});\r\n  const [hasMore,setHasMore] = useState(false);\r\n  const [successMsg,setSuccessMsg] = useState(null);\r\n  const [uploading,setUploading] = useState(false);\r\n  //const [loginAction,setLoginAction] =useState(initialLoginAction)\r\n\r\n  let loadMore=false\r\n\r\n  let selectedImageIdv=null\r\n\r\n  const triggerSelectInput=(e,input)=>{\r\n    e.preventDefault()\r\n     input.click()\r\n}\r\n\r\nuseEffect(()=>{\r\n  const uploadBt=document.getElementById(\"modal-upload-bt\")\r\n  const uploadInput=document.getElementById(\"modal-upload-input\")\r\n  uploadBt.addEventListener(\"click\",(e)=>triggerSelectInput(e,uploadInput))\r\n  // document.addEventListener(\"click\",(e)=>{ \r\n  //   if (e.target.tagName == 'A' && e.target.classList.contains(\"acpb_featured_delete\")) {\r\n  //     e.preventDefault(); \r\n  //     deletePhoto()\r\n  //     //setSelectedImageEn(\"\")\r\n  //     //updateArticle(\"featured_en\",null)\r\n  //   }\r\n  // })\r\n  //console.log(\"gallery from useEffect\",gallery)\r\n\r\n   fetchGallery()\r\n},[])\r\n\r\n\r\n\r\n\r\nuseEffect(()=>{\r\nif(pagination.next_page_url && pagination.next_page_url!==null){\r\n  setHasMore(true)\r\n//alert.show(pagination.next_page_url,{type: 'error',position:\"bottom center\"})\r\n}else{\r\n  setHasMore(false)\r\n} \r\n},[pagination])\r\n\r\nuseEffect(()=>{\r\n  selectedImageIdv=selectedImageId\r\n  },[selectedImageId])\r\n\r\n \r\n\r\n const fetchGallery=async=>{\r\n  updateGallery([])\r\n  setSelectedImage(\"\")\r\n  setSelectedImageId(\"\")\r\n  axios.request( {\r\n    method: \"get\", \r\n    url: API_URL+\"photo/all\", \r\n    // data: data, \r\n    onUploadProgress: (p) => {\r\n       setUploadProgress(prevProgress=>prevProgress+Math.round((100 * p.loaded) / p.total))\r\n       //console.log(\"upload progress\",p.total/p.loaded)\r\n    }\r\n\r\n\r\n  }).then (response => {\r\n      //console.log(\"response file name\",response.data.data.data.data)\r\n    \r\n      updateGallery(prevGallery=>[\r\n        ...prevGallery,...response.data.data.data.data\r\n      ])\r\n\r\n      setPagination(prevArticle=>{\r\n        return {...prevArticle,...response.data.data.data}\r\n      })\r\n\r\n     // console.log(\"initial api fetch\",response)\r\n  })\r\n\r\n }\r\n\r\n\r\n const deletePhoto=()=>{\r\n  //updateGallery([])\r\n  setLoginAction(initialLoginAction)\r\n\r\n   axios.get(API_URL+\"photo/delete/\"+selectedImageId,{headers: authHeader() }).then (response => {\r\n //fetchGallery()\r\n const newList = gallery.filter((item) => item.id !== selectedImageId);\r\n updateGallery(newList);\r\n setSelectedImage(\"\")\r\n\r\n console.log('delete image response',response)\r\n  }).catch(error => {\r\n    if(error.response){\r\n      if(error.response.status){\r\n           switch(error.response.status) {\r\n        case 500:\r\n            alert.show(error.response.statusText,{type: 'error'})\r\n          break;\r\n          case 401:\r\n            alert.show(\"Token error\",{type:'notice'})\r\n            setAuthModal(true)\r\n            setLoginAction(prevArticle=>{\r\n              return {...prevArticle,func:deletePhoto,params:selectedImageId}\r\n            })\r\n            \r\n          break;\r\n        default:\r\n            !error.response ? setSuccessMsg(\"Server currently down\"):\r\n            setSuccessMsg(error.response.statusText)\r\n      }     \r\n      }else{\r\n        setSuccessMsg(\"Server currently down\")\r\n      }\r\n    }else{\r\n      setSuccessMsg(\"Invalid response\")\r\n    }\r\n    // let apiStatus=error.response!==undefined ? error.response.statusText : \"Unknown error\"\r\n    // setErrors(prevError=>[...prevError,apiStatus])\r\n    \r\n});\r\n\r\n }\r\n\r\n\r\n\r\n const LoadMore=()=>{\r\n\r\n\r\npagination.next_page_url==null && setHasMore(false)\r\n\r\npagination.next_page_url!==null && axios.request( {\r\n    method: \"get\", \r\n    url: pagination.next_page_url, \r\n  }).then (response => {\r\n      //console.log(\"response file name\",response.data.data.data.data)\r\n    \r\n      updateGallery(prevGallery=>[\r\n        ...prevGallery,...response.data.data.data.data\r\n      ])\r\n\r\n      setPagination(prevArticle=>{\r\n        return {...prevArticle,...response.data.data.data}\r\n      })\r\n\r\n     // console.log(\"initial api fetch\",response)\r\n  })\r\n\r\n }\r\n\r\n\r\n\r\n\r\n\r\nconst onChange=(e)=>{\r\n  //console.log(e.target.value)\r\n  setUploadProgress(0)\r\n  let file=null\r\n  file = e.target.files[0] || e.dataTransfer.files[0];\r\n  e.target.value = \"\";\r\n  let allowed_mime_types = [ 'image/jpeg', 'image/png' ];\r\n  let allowed_size_mb = 2;\r\n  \r\n  if(allowed_mime_types.indexOf(file.type) == -1) {\r\n//alert('Error : Incorrect file type');\r\nsetSuccessMsg(\"Incorrect file type\")\r\n//alert.show(\"Incorrect file type\",{type: 'error',position:\"top right\",containerStyle:{zIndex: 4}})\r\nreturn;\r\n}\r\n\r\nif(file.size > allowed_size_mb*1024*1024) {\r\n//alert('Error : Exceeded size');\r\nsetSuccessMsg(\"Size limit of 2mb Exceeded\")\r\n//alert.show(\"Size limit of 1mb Exceeded\",{type: 'error',position:\"top right\"})\r\nreturn;\r\n}\r\n  //alert(\"on change for loading files\")\r\n  if (!file)\r\n  return;\r\n\r\n  // \r\n  setSuccessMsg(null)\r\n  setUploading(true)\r\n  //this.createImage(files[0]);\r\n  let reader = new FileReader();\r\n  reader.onload = (e) => {\r\n  //setImage(reader.result)\r\n  //console.log(reader.result)\r\n\r\n  };\r\n  reader.readAsDataURL(file);\r\n\r\n  let data = new FormData();\r\n\r\n  data.append(\"file\",file);\r\n  \r\n  axios.request( {\r\n      method: \"post\", \r\n      url: API_URL+\"photo/upload\", \r\n      data: data, \r\n      onUploadProgress: (p) => {\r\n         setUploadProgress(prevProgress=>prevProgress+Math.round((100 * p.loaded) / p.total))\r\n         //console.log(\"upload progress\",p.total/p.loaded)\r\n      }\r\n\r\n\r\n    }).then (response => {\r\n      updateGallery([])\r\n      //setHasMore(true)\r\n        // updateGallery(prevGallery=>[\r\n        //   ...prevGallery,...response.data.data.data.data\r\n        // ])\r\n\r\n        // setPagination(prevArticle=>{\r\n        //   return {...prevArticle,...response.data.data.data}\r\n        // })\r\n        //alert.show(\"Success\",{type: 'success'})\r\n        //console.log(\"Adding new image\",response.data.data.data)\r\n        //  updateGallery(prevGallery=>[\r\n        //   ...prevGallery,response.data.data.data\r\n        // ])\r\n        //fetchGallery()\r\n        \r\n        let imageBig=PUBLIC_URL+response.data.data.data.img_big\r\n        setSelectedImage(imageBig)\r\n        setSelectedImageId(response.data.data.data.id)\r\n        setFileType(response.data.data.data.file_type)\r\n        setFileName(response.data.data.data.file_original_name)\r\n        setFileSize(response.data.data.data.file_size)\r\n        setFileUploadedOn(response.data.data.data.created_at)\r\n       updateGallery(prevGallery=> [response.data.data.data,...gallery])\r\n\r\n        setPagination(response.data.data.pagination)\r\n        console.log(\"Added new image\",gallery)\r\n        setUploading(false)\r\n        \r\n    }).catch(error => {\r\n      setUploading(false)\r\n      if(error.response){\r\n        if(error.response.status){\r\n             switch(error.response.status) {\r\n          case 500:\r\n              alert.show(error.response.statusText,{type: 'error'})\r\n            break;\r\n            case 401:\r\n              //alert.show(\"Token error\",{type:'notice'})\r\n              // setAuthModal(true)\r\n              // setLoginAction(prevArticle=>{\r\n              //   return {...prevArticle,func:fetchArticleByIdApi,params:id}\r\n              // })\r\n              \r\n            break;\r\n          default:\r\n              !error.response ? setSuccessMsg(\"Server currently down\"):\r\n              setSuccessMsg(error.response.statusText)\r\n        }     \r\n        }else{\r\n          setSuccessMsg(\"Server currently down\")\r\n        }\r\n      }else{\r\n        setSuccessMsg(\"Invalid response\")\r\n      }\r\n      // let apiStatus=error.response!==undefined ? error.response.statusText : \"Unknown error\"\r\n      // setErrors(prevError=>[...prevError,apiStatus])\r\n      \r\n  });\r\n}\r\n\r\n\r\n    \r\n    return (\r\n        <>\r\n      \r\n      <CModal\r\n      size=\"lg\"\r\n        show={modal}\r\n        onClose={()=>{setModal(!modal); setSuccessMsg(null)}}\r\n      >\r\n        <CModalHeader closeButton>\r\n        \r\n          <h3>Gallery</h3>  \r\n          </CModalHeader>\r\n        <CModalBody>\r\n          <CRow>\r\n              <CCol md=\"8\">\r\n                {\r\n              <>\r\n                    {\r\n                \r\n           gallery.length ?\r\n          <InfiniteScroll\r\n          dataLength={gallery.length}\r\n          next={()=>LoadMore()}\r\n          hasMore={hasMore}\r\n          loader={\"\"}\r\n         \r\n          scrollableTarget=\"scrollableDiv\"\r\n          endMessage={\r\n            <p style={{ textAlign: \"center\" }}>\r\n              <b></b>\r\n            </p>\r\n          }\r\n        >\r\n        {/* <div className=\"row\"> */}\r\n\r\n                 <div className=\"container\">\r\n                    <div className=\"container\" id=\"scrollableDiv\" style={{overflowY:\"auto\",height:\"370px\"}}>\r\n                      <div className=\"d-flex flex-row flex-wrap align-items-start\">\r\n          {\r\n\r\n            \r\n\r\n        gallery.length  && gallery.map((val, k) => {\r\n\r\n        let imgSmall=PUBLIC_URL+val.img_small\r\n        let imageBig=PUBLIC_URL+val.img_big\r\n\r\n        //alert(\"check\")\r\n          return (\r\n          <div className=\"col-md-4\" style={{padding:\"1em\",cursor:\"pointer\"}} key={k}>\r\n              <img src={imgSmall} className={'img-thumbnail'} onClick={() => {\r\n        //let imageSource=document.getElementById(\"modal-selected-image\").src.value=val\r\n                setSelectedImage(imageBig)\r\n                setSelectedImageId(val.id)\r\n                setFileType(val.file_type)\r\n                setFileName(val.file_original_name)\r\n                setFileSize(val.file_size)\r\n                setFileUploadedOn(val.created_at)\r\n              }} />\r\n          </div>\r\n          )\r\n          })\r\n          \r\n          }\r\n\r\n          {/* </div> */}\r\n                </div>\r\n                </div>\r\n            </div>\r\n        </InfiniteScroll> :\"\"\r\n\r\n\r\n                    }\r\n\r\n\r\n\r\n\r\n               \r\n            </>\r\n        \r\n                  \r\n              \r\n\r\n             \r\n                 \r\n                }\r\n                \r\n                \r\n                {/* {gallery.length ? \"Showing \":<h3>No images found</h3> } \r\n                <b>{gallery.length ? pagination.from:\"\"}</b>-<b>{gallery.length ? pagination.to:\"\"}</b> {gallery.length ? \"results of\":\"\"} <b>{gallery.length ? Math.ceil(pagination.total/pagination.per_page): \"\"  } {gallery.length ? \"pages\":\"\"}</b>  */}\r\n                 {hasMore ? <b>(scroll down for more images)</b>:\"\"}\r\n                \r\n\r\n              </CCol>\r\n\r\n\r\n              <CCol md=\"4\">\r\n              <img  className={'img-fluid'} id=\"modal-selected-image\" src={selectedImage!==\"\"?selectedImage:\"\"} />\r\n\r\n              {selectedImage!==\"\" && <p align=\"center\" id=\"acpb_ft_rm_fr\"><a href=\"\" style={Styles.link} id=\"acpb_del_ft\" className=\"acpb_featured_delete\" style={{color:\"red\",textDecoration:\"underline\"}} onClick={(e)=>{ e.preventDefault(); deletePhoto()} }>delete</a></p>} \r\n\r\n              {selectedImage!==\"\" && \r\n              <>\r\n              <p><b>File name:</b> {fileName}</p>\r\n              <p><b>File type:</b> {fileType}</p>\r\n              <p><b>File size:</b> {fileSize}kb</p>\r\n              <p><b>Uploaded on:</b> {fileUploadedOn}</p>\r\n              \r\n              </>}\r\n              </CCol>\r\n          </CRow>\r\n          <CRow className=\"d-flex flex-row justify-content-center\">\r\n              {/* <CCol md=\"8\">Left</CCol>\r\n              <CCol md=\"4\">Right</CCol> */}\r\n              \r\n              <CCol md=\"4\">\r\n              <br />\r\n              <br />\r\n              <input id=\"modal-upload-input\" type=\"file\"  hidden={true} onChange={(e)=>onChange(e)} />\r\n            \r\n                \r\n                     <CButton id=\"modal-upload-bt\" color=\"primary\" size=\"md\" block md=\"12\">\r\n                     { uploading ? <><span\r\n                        className=\"spinner-grow spinner-grow-sm\"\r\n                        role=\"status\"\r\n                        aria-hidden=\"true\"\r\n                      ></span>\r\n                      &nbsp; Uploading...</> :\r\n                       \"Add IMage\" }\r\n                       </CButton>\r\n              \r\n              \r\n              {/* ({uploadProgress}% uploaded) */}\r\n              <CProgress className=\"progress-xs\" color=\"success\" value={uploadProgress} />\r\n              {successMsg!==null && <b style={{color:\"red\"}} >{successMsg}</b>}\r\n              </CCol>\r\n          </CRow>\r\n        </CModalBody>\r\n        <CModalFooter>\r\n          <CButton color=\"primary\" onClick={()=>{\r\n            \r\n            if(featuredFor!==\"\") {\r\n              //setting featured image\r\n              setModal(prev=>!prev)\r\n              //console.log(\"selected Image\",selectedImage)\r\n              //console.log(\"Featured For\",featuredFor)\r\n              if(featuredFor==\"acpb_en_ft\"){\r\n                updateArticle(\"featured_en\",selectedImage)\r\n                setSelectedImageEn(selectedImage)\r\n              }else{\r\n                updateArticle(\"featured_fr\",selectedImage)\r\n                setSelectedImageFr(selectedImage)\r\n              }\r\n              \r\n               \r\n            }else{\r\n              //setting featured image\r\n              setModal(prev=>!prev)\r\n              selectedImage!==\"\" && setSelectedImageGlobal(selectedImage)\r\n\r\n            }\r\n            \r\n            }}>OK</CButton>{' '}\r\n\r\n          <CButton\r\n            color=\"secondary\"\r\n            onClick={()=>{setModal(!modal); setSuccessMsg(null)}}\r\n          >Cancel</CButton>\r\n        </CModalFooter>\r\n      </CModal>\r\n    </>\r\n           \r\n      )\r\n\r\n}\r\n\r\n\r\n\r\nexport default ModalMe"]},"metadata":{},"sourceType":"module"}